<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Scholarships</title>

  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <!-- PapaParse for CSV parsing -->
  <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>

  <!-- SheetJS for XLSX reading -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>


  <style>
    body { 
      margin: 0;
      padding: 0;
      background: black;
      color: #fff;
      font-family: 'Montserrat', sans-serif;
    }

    /* Starry background */
    canvas#stars {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      background: black;
    }

        /* Navbar */
    .navbar {
      background: linear-gradient(90deg, #0d0d0d, #1a1a1a);
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.1);
    }

    .navbar-brand span {
      color: #ffffff;
      text-shadow: 0 0 8px rgba(255,255,255,0.6);
    }

    .nav-link {
      color: #ccc;
      transition: color 0.3s, text-shadow 0.3s;
    }

    .nav-link:hover {
      color: #fff;
      text-shadow: 0 0 10px #00ffff;
    }

    /* Cool Title */
    .cool-title {
      font-size: 3rem;
      font-weight: 700;
      text-align: center;
      margin-bottom: 2rem;
      background: linear-gradient(90deg, #00ffff, #ff00ff);
      background-clip: text;
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      color: transparent;
      text-shadow: 2px 2px 8px rgba(0,255,255,0.4);
    }

    @media (max-width: 767px) {
      .cool-title {
        font-size: 2rem;
      }
      .column-toggles {
        display: none;
      }
    }

    /* Cards */
    .card {
      background: rgba(10, 10, 20, 0.9);
      border-left: 6px solid #00ffff;
      box-shadow: 0 4px 20px rgba(0,255,255,0.2);
      margin-bottom: 1rem;
    }

    .card-header {
      font-weight: bold;
      color: #00ffff;
    }

    .card-body p {
      margin-bottom: 0.25rem;
    }

    /* Table adjustments */
    .table-view table {
      background: rgba(15,15,25,0.9);
      color: #fff;
    }

    .table-view thead {
      background-color: #111;
    }

    .table-view th, .table-view td {
      vertical-align: middle;
      color: #fff;
    }

    /* Cool text gradient for names in cards */
    .cool-text {
      font-weight: 800;
      font-size: 1.8rem;
      background: linear-gradient(90deg, #00ffff, #ff00ff);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      color: transparent;
      text-shadow: 2px 2px 8px rgba(0,255,255,0.4);
      transition: transform 0.3s, text-shadow 0.3s;
    }

    .cool-text:hover {
      transform: scale(1.1);
      text-shadow: 4px 4px 12px rgba(0,255,255,0.6);
    }

    /* Responsive hiding of views */
    @media (min-width: 768px) { .card-view { display: none; } }
    @media (max-width: 767px) { .table-view { display: none; } }

    /* Table adjustments for dark space theme */
    /* Force table to be fully black inside and out */
    .table-view table {
      background-color: #000 !important; /* table background */
      color: #fff !important;
      border-color: #333 !important;
    }

    /* Table headers */
    .table-view thead th {
      background-color: #000 !important; /* header background */
      color: #fff !important;
      border-color: #333 !important;
    }

    /* Table body cells */
    .table-view tbody td {
      background-color: #000 !important; /* make each cell black */
      color: #fff !important;
      border-color: #333 !important;
    }

    /* Remove Bootstrap striping */
    .table-view.table-striped tbody tr:nth-of-type(odd),
    .table-view.table-striped tbody tr:nth-of-type(even) {
      background-color: #000 !important;
    }

    /* Links inside table */
    .table-view a {
      color: #0ff !important;
      text-decoration: none;
    }

    .table-view a:hover {
      color: #fff !important;
      text-shadow: 0 0 8px #0ff;
    }



  </style>
</head>
<body>

<canvas id="stars"></canvas>

<!-- Navbar -->
<nav class="navbar navbar-expand-lg navbar-dark mb-4">
  <div class="container">
    <a class="navbar-brand" href="index.html">
      <span>S</span><span>C</span><span>H</span><span>O</span><span>L</span><span>A</span><span>R</span><span>S</span><span>H</span><span>I</span><span>P</span><span>S</span>
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" 
      aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav ms-auto">
        <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
        <li class="nav-item"><a class="nav-link active" href="US.html">US and International Scholarships</a></li>
        <li class="nav-item"><a class="nav-link" href="counsellors.html">Contact</a></li>
      </ul>
    </div>
  </div>
</nav>

<div class="container mb-5">
  <h1 class="cool-title">US and International Scholarships</h1>

  <!-- Filter input -->
  <div class="mb-3">
    <input type="text" id="filterInput" class="form-control" placeholder="Search scholarships...">
  </div>

  <!-- Column toggle checkboxes -->
  <div class="mb-3 column-toggles">
    <label class="form-check-label me-2"><input class="form-check-input column-toggle" type="checkbox" data-column="3" checked> Type</label>
    <label class="form-check-label me-2"><input class="form-check-input column-toggle" type="checkbox" data-column="4" checked> How Much</label>
    <label class="form-check-label me-2"><input class="form-check-input column-toggle" type="checkbox" data-column="5" checked> Deadline</label>
    <label class="form-check-label me-2"><input class="form-check-input column-toggle" type="checkbox" data-column="6" checked> No additional application</label>
  </div>

  <!-- Desktop table -->
  <div class="table-responsive table-view shadow-sm rounded">
    <table class="table table-striped table-bordered align-middle" id="scholarshipTable">
      <thead class="table-dark">
        <tr>
          <th>Scholarship Name</th>
          <th>College/University</th>
          <th>Country</th>
          <th>Type</th>
          <th>How Much</th>
          <th>Deadline</th>
          <th>No additional application</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Mobile cards -->
  <div class="card-view" id="cardContainer"></div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

<script>
// Starry background
const canvas = document.getElementById('stars');
const ctx = canvas.getContext('2d');
let stars = [];
const numStars = 200;
function resizeCanvas() {
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();
for (let i = 0; i < numStars; i++) {
  stars.push({
    x: Math.random() * canvas.width,
    y: Math.random() * canvas.height,
    radius: Math.random() * 1.5 + 0.5,
    alpha: Math.random(),
    delta: Math.random() * 0.02
  });
}
function animateStars() {
  ctx.clearRect(0, 0, canvas.width, canvas.height);
  for (let star of stars) {
    ctx.beginPath();
    ctx.arc(star.x, star.y, star.radius, 0, 2 * Math.PI);
    ctx.fillStyle = `rgba(255, 255, 255, ${star.alpha})`;
    ctx.fill();
    star.alpha += star.delta;
    if (star.alpha <= 0 || star.alpha >= 1) star.delta *= -1;
  }
  requestAnimationFrame(animateStars);
}
animateStars();

// Load and parse XLSX
async function loadExcel() {
  const response = await fetch("scholarships.xlsx");
  const arrayBuffer = await response.arrayBuffer();
  const workbook = XLSX.read(arrayBuffer, { type: "array" });
  const firstSheetName = workbook.SheetNames[0];
  const worksheet = workbook.Sheets[firstSheetName];
  const data = XLSX.utils.sheet_to_json(worksheet, { defval: "", raw: false });

  data.forEach(row => {
    const val = row["Deadline"];
    if (!isNaN(Date.parse(val))) {
      const d = new Date(val);
      const options = { month: "long", day: "numeric" };
      row["Deadline"] = d.toLocaleDateString("en-US", options);
    }
  });

  const tableBody = document.querySelector('#scholarshipTable tbody');
  const cardContainer = document.querySelector('#cardContainer');

  data.forEach((row, index) => {
    let scholarshipNameCell = row["Scholarship Name"];
    const cellAddress = `A${index + 2}`;
    const cell = worksheet[cellAddress];
    let linkHTML = scholarshipNameCell;
    if (cell && cell.l && cell.l.Target) {
      linkHTML = `<a href="${cell.l.Target}" target="_blank">${scholarshipNameCell}</a>`;
    }

    const tr = document.createElement("tr");
    tr.innerHTML = `
      <td>${linkHTML || ''}</td>
      <td>${row['College/University'] || ''}</td>
      <td>${row['Country'] || ''}</td>
      <td>${row['Type'] || ''}</td>
      <td>${row['How Much'] || ''}</td>
      <td>${row['Deadline'] || ''}</td>
      <td>${row['No additional application'] || ''}</td>
    `;
    tableBody.appendChild(tr);

    const card = document.createElement("div");
    card.className = "card scholar-card";
    card.innerHTML = `
      <div class="card-header">${linkHTML || ''}</div>
      <div class="card-body">
        <p><strong>College/University:</strong> ${row['College/University'] || ''}</p>
        <p><strong>Country:</strong> ${row['Country'] || ''}</p>
        <p><strong>Type:</strong> ${row['Type'] || ''}</p>
        <p><strong>How Much:</strong> ${row['How Much'] || ''}</p>
        <p><strong>Deadline:</strong> ${row['Deadline'] || ''}</p>
        <p><strong>No additional application:</strong> ${row['No additional application'] || ''}</p>
      </div>
    `;
    cardContainer.appendChild(card);
  });

  const toggles = document.querySelectorAll('.column-toggle');
  toggles.forEach(toggle => {
    toggle.addEventListener('change', () => {
      const colIndex = toggle.dataset.column;
      const table = document.getElementById('scholarshipTable');
      for (let row of table.rows) {
        if (row.cells[colIndex]) {
          row.cells[colIndex].style.display = toggle.checked ? '' : 'none';
        }
      }
    });
  });

  const filterInput = document.getElementById('filterInput');
  filterInput.addEventListener('input', () => {
    const query = filterInput.value.toLowerCase();
    data.forEach((row, index) => {
      const searchableText = [
        row['Scholarship Name'],
        row['College/University'],
        row['Country'],
        row['Type']
      ].join(' ').toLowerCase();
      const match = searchableText.includes(query);
      tableBody.rows[index].style.display = match ? '' : 'none';
      cardContainer.children[index].style.display = match ? '' : 'none';
    });
  });
}

loadExcel();
</script>
</body>
</html>
